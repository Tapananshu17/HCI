import { useState, useRef, useEffect } from 'react';
import { ArrowLeft, Send, Bot, User, AlertCircle } from 'lucide-react';
import { Button } from './ui/button';
import { Textarea } from './ui/textarea';
import { Card } from './ui/card';
import { Avatar, AvatarFallback } from './ui/avatar';
import { Alert, AlertDescription } from './ui/alert';
import { LanguageSelector } from './LanguageSelector';
import type { Page, UserProfile, TestType, Language } from '../App';

interface ChatbotPageProps {
  userProfile: UserProfile;
  setUserProfile: (profile: UserProfile) => void;
  navigateTo: (page: Page) => void;
  showResults?: boolean;
}

interface Message {
  id: number;
  text: string;
  sender: 'user' | 'bot';
  timestamp: Date;
}

const botResponses: { [key: string]: { [key in Language]: string } } = {
  'science': {
    en: 'Science stream is great! You can pursue careers in Engineering, Medicine, Research, and Technology.',
    hi: '‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ ‡§¨‡§π‡•Å‡§§ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§π‡•à! ‡§Ü‡§™ ‡§á‡§Ç‡§ú‡•Ä‡§®‡§ø‡§Ø‡§∞‡§ø‡§Ç‡§ó, ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ, ‡§Ö‡§®‡•Å‡§∏‡§Ç‡§ß‡§æ‡§® ‡§î‡§∞ ‡§™‡•ç‡§∞‡•å‡§¶‡•ç‡§Ø‡•ã‡§ó‡§ø‡§ï‡•Ä ‡§Æ‡•á‡§Ç ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§¨‡§®‡§æ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§',
    te: '‡∞∏‡±à‡∞®‡±ç‡∞∏‡±ç ‡∞∏‡±ç‡∞ü‡±ç‡∞∞‡±Ä‡∞Æ‡±ç ‡∞ó‡±ä‡∞™‡±ç‡∞™‡∞¶‡∞ø! ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞á‡∞Ç‡∞ú‡∞®‡±Ä‡∞∞‡∞ø‡∞Ç‡∞ó‡±ç, ‡∞Æ‡±Ü‡∞°‡∞ø‡∞∏‡∞ø‡∞®‡±ç, ‡∞™‡∞∞‡∞ø‡∞∂‡±ã‡∞ß‡∞® ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞ü‡±Ü‡∞ï‡±ç‡∞®‡∞æ‡∞≤‡∞ú‡±Ä‡∞≤‡±ã ‡∞ï‡±Ü‡∞∞‡±Ä‡∞∞‡±ç‡∞≤‡±Å ‡∞ö‡±á‡∞Ø‡∞µ‡∞ö‡±ç‡∞ö‡±Å‡•§',
    ta: '‡ÆÖ‡Æ±‡Æø‡Æµ‡Æø‡ÆØ‡Æ≤‡Øç ‡Æ™‡Æø‡Æ∞‡Æø‡Æµ‡ØÅ ‡Æö‡Æø‡Æ±‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ! ‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Øä‡Æ±‡Æø‡ÆØ‡Æø‡ÆØ‡Æ≤‡Øç, ‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ‡ÆÆ‡Øç, ‡ÆÜ‡Æ∞‡Ææ‡ÆØ‡Øç‡Æö‡Øç‡Æö‡Æø ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç‡Æ®‡ØÅ‡Æü‡Øç‡Æ™‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æ≤‡Ææ‡ÆÆ‡Øç.',
    bn: '‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶ß‡¶æ‡¶∞‡¶æ ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¶‡¶æ‡¶®‡ßç‡¶§! ‡¶Ü‡¶™‡¶®‡¶ø ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø‡¶Ç, ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ, ‡¶ó‡¶¨‡ßá‡¶∑‡¶£‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡¶®‡•§',
    gu: '‡™µ‡™ø‡™ú‡´ç‡™û‡™æ‡™® ‡™™‡´ç‡™∞‡™µ‡™æ‡™π ‡™∂‡´ç‡™∞‡´á‡™∑‡´ç‡™† ‡™õ‡´á! ‡™§‡™Æ‡´á ‡™è‡™®‡´ç‡™ú‡™ø‡™®‡™ø‡™Ø‡™∞‡™ø‡™Ç‡™ó, ‡™Æ‡´á‡™°‡™ø‡™∏‡™ø‡™®, ‡™∏‡™Ç‡™∂‡´ã‡™ß‡™® ‡™Ö‡™®‡´á ‡™ü‡´á‡™ï‡´ç‡™®‡´ã‡™≤‡´ã‡™ú‡´Ä‡™Æ‡™æ‡™Ç ‡™ï‡™æ‡™∞‡™ï‡™ø‡™∞‡´ç‡™¶‡´Ä ‡™¨‡™®‡™æ‡™µ‡´Ä ‡™∂‡™ï‡´ã ‡™õ‡´ã.'
  },
  'commerce': {
    en: 'Commerce stream opens doors to Business, Finance, Accounting, and Management careers.',
    hi: '‡§µ‡§æ‡§£‡§ø‡§ú‡•ç‡§Ø ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞, ‡§µ‡§ø‡§§‡•ç‡§§, ‡§≤‡•á‡§ñ‡§æ‡§Ç‡§ï‡§® ‡§î‡§∞ ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§® ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§ï‡•á ‡§¶‡§∞‡§µ‡§æ‡§ú‡•á ‡§ñ‡•ã‡§≤‡§§‡•Ä ‡§π‡•à‡•§',
    te: '‡∞ï‡∞æ‡∞Æ‡∞∞‡±ç‡∞∏‡±ç ‡∞∏‡±ç‡∞ü‡±ç‡∞∞‡±Ä‡∞Æ‡±ç ‡∞¨‡∞ø‡∞ú‡∞ø‡∞®‡±Ü‡∞∏‡±ç, ‡∞´‡±à‡∞®‡∞æ‡∞®‡±ç‡∞∏‡±ç, ‡∞Ö‡∞ï‡±å‡∞Ç‡∞ü‡∞ø‡∞Ç‡∞ó‡±ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞Æ‡±á‡∞®‡±á‡∞ú‡±ç‚Äå‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç ‡∞ï‡±Ü‡∞∞‡±Ä‡∞∞‡±ç‡∞≤‡∞ï‡±Å ‡∞§‡∞≤‡±Å‡∞™‡±Å‡∞≤‡±Å ‡∞§‡±Ü‡∞∞‡±Å‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø‡•§',
    ta: '‡Æµ‡Æ∞‡Øç‡Æ§‡Øç‡Æ§‡Æï ‡Æ™‡Æø‡Æ∞‡Æø‡Æµ‡ØÅ ‡Æµ‡Æ£‡Æø‡Æï‡ÆÆ‡Øç, ‡Æ®‡Æø‡Æ§‡Æø, ‡Æï‡Æ£‡Æï‡Øç‡Æï‡Æø‡ÆØ‡Æ≤‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡Øá‡Æ≤‡Ææ‡Æ£‡Øç‡ÆÆ‡Øà ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æµ‡Æ¥‡Æø ‡Æ§‡Æø‡Æ±‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ.',
    bn: '‡¶¨‡¶æ‡¶£‡¶ø‡¶ú‡ßç‡¶Ø ‡¶ß‡¶æ‡¶∞‡¶æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ, ‡¶Ö‡¶∞‡ßç‡¶•, ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶è‡¶¨‡¶Ç ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶®‡¶æ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‡¶¶‡¶∞‡¶ú‡¶æ ‡¶ñ‡ßã‡¶≤‡ßá‡•§',
    gu: '‡™ï‡´ã‡™Æ‡™∞‡´ç‡™∏ ‡™™‡´ç‡™∞‡™µ‡™æ‡™π ‡™¨‡™ø‡™ù‡™®‡´á‡™∏, ‡™´‡™æ‡™á‡™®‡™æ‡™®‡´ç‡™∏, ‡™è‡™ï‡™æ‡™â‡™®‡´ç‡™ü‡™ø‡™Ç‡™ó ‡™Ö‡™®‡´á ‡™Æ‡´á‡™®‡´á‡™ú‡™Æ‡´á‡™®‡´ç‡™ü ‡™ï‡™æ‡™∞‡™ï‡™ø‡™∞‡´ç‡™¶‡´Ä‡™®‡™æ ‡™¶‡™∞‡™µ‡™æ‡™ú‡™æ ‡™ñ‡´ã‡™≤‡´á ‡™õ‡´á.'
  },
  'default': {
    en: 'That\'s a great question! I recommend taking our assessments to understand your strengths better.',
    hi: '‡§Ø‡§π ‡§è‡§ï ‡§¨‡•á‡§π‡§§‡§∞‡•Ä‡§® ‡§∏‡§µ‡§æ‡§≤ ‡§π‡•à! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§§‡§æ‡§ï‡§§ ‡§ï‡•ã ‡§¨‡•á‡§π‡§§‡§∞ ‡§¢‡§Ç‡§ó ‡§∏‡•á ‡§∏‡§Æ‡§ù‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡§Æ‡§æ‡§∞‡•á ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® ‡§≤‡•á‡§®‡•á ‡§ï‡•Ä ‡§∏‡§≤‡§æ‡§π ‡§¶‡•á‡§§‡§æ ‡§π‡•Ç‡§Ç‡•§',
    te: '‡∞Ö‡∞¶‡∞ø ‡∞ó‡±ä‡∞™‡±ç‡∞™ ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®! ‡∞Æ‡±Ä ‡∞¨‡∞≤‡∞æ‡∞≤‡∞®‡±Å ‡∞Æ‡±Ü‡∞∞‡±Å‡∞ó‡±ç‡∞ó‡∞æ ‡∞Ö‡∞∞‡±ç‡∞•‡∞Ç ‡∞ö‡±á‡∞∏‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞Æ‡∞æ ‡∞Ö‡∞∏‡±Ü‡∞∏‡±ç‚Äå‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç‚Äå‡∞≤‡±Å ‡∞§‡±Ä‡∞∏‡±Å‡∞ï‡±ã‡∞µ‡∞æ‡∞≤‡∞®‡∞ø ‡∞®‡±á‡∞®‡±Å ‡∞∏‡∞ø‡∞´‡∞æ‡∞∞‡±ç‡∞∏‡±Å ‡∞ö‡±á‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞®‡±Å‡•§',
    ta: '‡ÆÖ‡Æ§‡ØÅ ‡Æí‡Æ∞‡ØÅ ‡Æö‡Æø‡Æ±‡Æ®‡Øç‡Æ§ ‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø! ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Æ≤‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡Æ®‡Æ©‡Øç‡Æï‡ØÅ ‡Æ™‡ØÅ‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ ‡Æï‡Øä‡Æ≥‡Øç‡Æ≥ ‡Æé‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÄ‡Æü‡ØÅ‡Æï‡Æ≥‡Øà ‡Æé‡Æü‡ØÅ‡Æï‡Øç‡Æï ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Øç‡Æï‡Æø‡Æ±‡Øá‡Æ©‡Øç.',
    bn: '‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶¶‡ßÅ‡¶∞‡ßç‡¶¶‡¶æ‡¶®‡ßç‡¶§ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®! ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∂‡¶ï‡ßç‡¶§‡¶ø ‡¶≠‡¶æ‡¶≤‡ßã‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡ßÅ‡¶ù‡¶§‡ßá ‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º‡¶® ‡¶®‡ßá‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞‡¶æ‡¶Æ‡¶∞‡ßç‡¶∂ ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø‡•§',
    gu: '‡™§‡´á ‡™è‡™ï ‡™∏‡™∞‡™∏ ‡™™‡´ç‡™∞‡™∂‡´ç‡™® ‡™õ‡´á! ‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™∂‡™ï‡´ç‡™§‡™ø‡™ì‡™®‡´á ‡™µ‡™ß‡´Å ‡™∏‡™æ‡™∞‡´Ä ‡™∞‡´Ä‡™§‡´á ‡™∏‡™Æ‡™ú‡™µ‡™æ ‡™Æ‡™æ‡™ü‡´á ‡™π‡´Å‡™Ç ‡™Ö‡™Æ‡™æ‡™∞‡™æ ‡™Æ‡´Ç‡™≤‡´ç‡™Ø‡™æ‡™Ç‡™ï‡™® ‡™≤‡´á‡™µ‡™æ‡™®‡´Ä ‡™≠‡™≤‡™æ‡™Æ‡™£ ‡™ï‡™∞‡´Å‡™Ç ‡™õ‡´Å‡™Ç.'
  }
};

const resultsMessages = {
  en: (name: string) => `Excellent work, ${name}! üéâ

Based on your complete assessment, here are your career recommendations:

üìä Your Strengths:
‚Ä¢ Strong analytical and problem-solving skills
‚Ä¢ Good technical aptitude
‚Ä¢ Creative thinking abilities

üéØ Recommended Streams:
1. Science - Engineering, Technology, Architecture
3. Commerce - Business, Finance, Management

üí° What would you like to explore further?`,
  hi: (name: string) => `‡§¨‡§π‡•Å‡§§ ‡§¨‡§¢‡§º‡§ø‡§Ø‡§æ, ${name}! üéâ

‡§Ü‡§™‡§ï‡•á ‡§™‡•Ç‡§∞‡•ç‡§£ ‡§Æ‡•Ç‡§≤‡•ç‡§Ø‡§æ‡§Ç‡§ï‡§® ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞, ‡§Ø‡§π‡§æ‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç ‡§π‡•à‡§Ç:

üìä ‡§Ü‡§™‡§ï‡•Ä ‡§§‡§æ‡§ï‡§§:
‚Ä¢ ‡§Æ‡§ú‡§¨‡•Ç‡§§ ‡§µ‡§ø‡§∂‡•ç‡§≤‡•á‡§∑‡§£‡§æ‡§§‡•ç‡§Æ‡§ï ‡§î‡§∞ ‡§∏‡§Æ‡§∏‡•ç‡§Ø‡§æ ‡§∏‡§Æ‡§æ‡§ß‡§æ‡§® ‡§ï‡•å‡§∂‡§≤
‚Ä¢ ‡§Ö‡§ö‡•ç‡§õ‡•Ä ‡§§‡§ï‡§®‡•Ä‡§ï‡•Ä ‡§Ø‡•ã‡§ó‡•ç‡§Ø‡§§‡§æ
‚Ä¢ ‡§∞‡§ö‡§®‡§æ‡§§‡•ç‡§Æ‡§ï ‡§∏‡•ã‡§ö ‡§ï‡•ç‡§∑‡§Æ‡§§‡§æ

üéØ  ‡§Ö‡§®‡•Å‡§∂‡§Ç‡§∏‡§ø‡§§ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ: 
1.  ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® (PCM)  - ‡§á‡§Ç‡§ú‡•Ä‡§®‡§ø‡§Ø‡§∞‡§ø‡§Ç‡§ó, ‡§™‡•ç‡§∞‡•å‡§¶‡•ç‡§Ø‡•ã‡§ó‡§ø‡§ï‡•Ä, ‡§µ‡§æ‡§∏‡•ç‡§§‡•Å‡§ï‡§≤‡§æ
2.  ‡§µ‡§ø‡§ú‡•ç‡§û‡§æ‡§® (PCB)  - ‡§ö‡§ø‡§ï‡§ø‡§§‡•ç‡§∏‡§æ, ‡§ú‡•à‡§µ ‡§™‡•ç‡§∞‡•å‡§¶‡•ç‡§Ø‡•ã‡§ó‡§ø‡§ï‡•Ä, ‡§Ö‡§®‡•Å‡§∏‡§Ç‡§ß‡§æ‡§®
3.  ‡§µ‡§æ‡§£‡§ø‡§ú‡•ç‡§Ø  - ‡§µ‡•ç‡§Ø‡§æ‡§™‡§æ‡§∞, ‡§µ‡§ø‡§§‡•ç‡§§, ‡§™‡•ç‡§∞‡§¨‡§Ç‡§ß‡§®

üí° ‡§Ü‡§™ ‡§Ü‡§ó‡•á ‡§ï‡•ç‡§Ø‡§æ ‡§ú‡§æ‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á?`,
  te: (name: string) => `‡∞Ö‡∞¶‡±ç‡∞≠‡±Å‡∞§‡∞Æ‡±à‡∞® ‡∞™‡∞®‡∞ø, ${name}! üéâ

‡∞Æ‡±Ä ‡∞™‡±Ç‡∞∞‡±ç‡∞§‡∞ø ‡∞Ö‡∞∏‡±Ü‡∞∏‡±ç‚Äå‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç ‡∞Ü‡∞ß‡∞æ‡∞∞‡∞Ç‡∞ó‡∞æ, ‡∞Æ‡±Ä ‡∞ï‡±Ü‡∞∞‡±Ä‡∞∞‡±ç ‡∞∏‡∞ø‡∞´‡∞æ‡∞∞‡±ç‡∞∏‡±Å‡∞≤‡±Å ‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞â‡∞®‡±ç‡∞®‡∞æ‡∞Ø‡∞ø:

üìä  ‡∞Æ‡±Ä ‡∞¨‡∞≤‡∞æ‡∞≤‡±Å: 
‚Ä¢ ‡∞¨‡∞≤‡∞Æ‡±à‡∞® ‡∞µ‡∞ø‡∞∂‡±ç‡∞≤‡±á‡∞∑‡∞£‡∞æ‡∞§‡±ç‡∞Æ‡∞ï ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞∏‡∞Æ‡∞∏‡±ç‡∞Ø ‡∞™‡∞∞‡∞ø‡∞∑‡±ç‡∞ï‡∞æ‡∞∞ ‡∞®‡±à‡∞™‡±Å‡∞£‡±ç‡∞Ø‡∞æ‡∞≤‡±Å
‚Ä¢ ‡∞Æ‡∞Ç‡∞ö‡∞ø ‡∞∏‡∞æ‡∞Ç‡∞ï‡±á‡∞§‡∞ø‡∞ï ‡∞®‡±à‡∞™‡±Å‡∞£‡±ç‡∞Ø‡∞Ç
‚Ä¢ ‡∞∏‡±É‡∞ú‡∞®‡∞æ‡∞§‡±ç‡∞Æ‡∞ï ‡∞Ü‡∞≤‡±ã‡∞ö‡∞® ‡∞∏‡∞æ‡∞Æ‡∞∞‡±ç‡∞•‡±ç‡∞Ø‡∞æ‡∞≤‡±Å

üéØ  ‡∞∏‡∞ø‡∞´‡∞æ‡∞∞‡±ç‡∞∏‡±Å ‡∞ö‡±á‡∞Ø‡∞¨‡∞°‡∞ø‡∞® ‡∞∏‡±ç‡∞ü‡±ç‡∞∞‡±Ä‡∞Æ‡±ç‚Äå‡∞≤‡±Å: 
1.  ‡∞∏‡±à‡∞®‡±ç‡∞∏‡±ç (PCM)  - ‡∞á‡∞Ç‡∞ú‡∞®‡±Ä‡∞∞‡∞ø‡∞Ç‡∞ó‡±ç, ‡∞ü‡±Ü‡∞ï‡±ç‡∞®‡∞æ‡∞≤‡∞ú‡±Ä, ‡∞Ü‡∞∞‡±ç‡∞ï‡∞ø‡∞ü‡±Ü‡∞ï‡±ç‡∞ö‡∞∞‡±ç
2.  ‡∞∏‡±à‡∞®‡±ç‡∞∏‡±ç (PCB)  - ‡∞Æ‡±Ü‡∞°‡∞ø‡∞ï‡∞≤‡±ç, ‡∞¨‡∞Ø‡±ã‡∞ü‡±Ü‡∞ï‡±ç‡∞®‡∞æ‡∞≤‡∞ú‡±Ä, ‡∞∞‡±Ä‡∞∏‡±Ü‡∞∞‡±ç‡∞ö‡±ç
3.  ‡∞ï‡∞æ‡∞Æ‡∞∞‡±ç‡∞∏‡±ç  - ‡∞¨‡∞ø‡∞ú‡∞ø‡∞®‡±Ü‡∞∏‡±ç, ‡∞´‡±à‡∞®‡∞æ‡∞®‡±ç‡∞∏‡±ç, ‡∞Æ‡±á‡∞®‡±á‡∞ú‡±ç‚Äå‡∞Æ‡±Ü‡∞Ç‡∞ü‡±ç

üí° ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞Æ‡∞∞‡∞ø‡∞Ç‡∞§ ‡∞è‡∞Æ‡∞ø ‡∞Ö‡∞®‡±ç‡∞µ‡±á‡∞∑‡∞ø‡∞Ç‡∞ö‡∞æ‡∞≤‡∞®‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞∞‡±Å?`,
  ta: (name: string) => `‡Æö‡Æø‡Æ±‡Æ™‡Øç‡Æ™‡Ææ‡Æ© ‡Æµ‡Øá‡Æ≤‡Øà, ${name}! üéâ

‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡ØÅ‡Æ¥‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡ØÄ‡Æü‡Øç‡Æü‡Æø‡Æ©‡Øç ‡ÆÖ‡Æü‡Æø‡Æ™‡Øç‡Æ™‡Æü‡Øà‡ÆØ‡Æø‡Æ≤‡Øç, ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øç ‡Æá‡Æ§‡Øã:

üìä  ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Æ≤‡Æô‡Øç‡Æï‡Æ≥‡Øç: 
‚Ä¢ ‡Æµ‡Æ≤‡ØÅ‡Æµ‡Ææ‡Æ© ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æö‡Æø‡Æï‡Øç‡Æï‡Æ≤‡Øç ‡Æ§‡ØÄ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æ§‡Æø‡Æ±‡Æ©‡Øç‡Æï‡Æ≥‡Øç
‚Ä¢ ‡Æ®‡Æ≤‡Øç‡Æ≤ ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç‡Æ®‡ØÅ‡Æü‡Øç‡Æ™ ‡Æ§‡Æø‡Æ±‡Æ©‡Øç
‚Ä¢ ‡Æ™‡Æü‡Øà‡Æ™‡Øç‡Æ™‡Ææ‡Æ±‡Øç‡Æ±‡Æ≤‡Øç ‡Æö‡Æø‡Æ®‡Øç‡Æ§‡Æ©‡Øà ‡Æ§‡Æø‡Æ±‡Æ©‡Øç‡Æï‡Æ≥‡Øç

üéØ  ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ™‡Æø‡Æ∞‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç: 
1.  ‡ÆÖ‡Æ±‡Æø‡Æµ‡Æø‡ÆØ‡Æ≤‡Øç (PCM)  - ‡Æ™‡Øä‡Æ±‡Æø‡ÆØ‡Æø‡ÆØ‡Æ≤‡Øç, ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç‡Æ®‡ØÅ‡Æü‡Øç‡Æ™‡ÆÆ‡Øç, ‡Æï‡Æü‡Øç‡Æü‡Æø‡Æü‡Æï‡Øç‡Æï‡Æ≤‡Øà
2.  ‡ÆÖ‡Æ±‡Æø‡Æµ‡Æø‡ÆØ‡Æ≤‡Øç (PCB)  - ‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ‡ÆÆ‡Øç, ‡Æâ‡ÆØ‡Æø‡Æ∞‡Æø ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç‡Æ®‡ØÅ‡Æü‡Øç‡Æ™‡ÆÆ‡Øç, ‡ÆÜ‡Æ∞‡Ææ‡ÆØ‡Øç‡Æö‡Øç‡Æö‡Æø
3.  ‡Æµ‡Æ∞‡Øç‡Æ§‡Øç‡Æ§‡Æï‡ÆÆ‡Øç  - ‡Æµ‡Æ£‡Æø‡Æï‡ÆÆ‡Øç, ‡Æ®‡Æø‡Æ§‡Æø, ‡ÆÆ‡Øá‡Æ≤‡Ææ‡Æ£‡Øç‡ÆÆ‡Øà

üí° ‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Øá‡Æ≤‡ØÅ‡ÆÆ‡Øç ‡Æé‡Æ©‡Øç‡Æ© ‡ÆÜ‡Æ∞‡Ææ‡ÆØ ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡Æï‡Æø‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç?`,
  bn: (name: string) => `‡¶ö‡¶Æ‡ßé‡¶ï‡¶æ‡¶∞ ‡¶ï‡¶æ‡¶ú, ${name}! üéâ

‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶Æ‡ßÇ‡¶≤‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡ßá‡¶∞ ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá, ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞‡¶ø‡¶∂ ‡¶∞‡¶Ø‡¶º‡ßá‡¶õ‡ßá:

üìä  ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∂‡¶ï‡ßç‡¶§‡¶ø: 
‚Ä¢ ‡¶∂‡¶ï‡ßç‡¶§‡¶ø‡¶∂‡¶æ‡¶≤‡ßÄ ‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£‡¶æ‡¶§‡ßç‡¶Æ‡¶ï ‡¶è‡¶¨‡¶Ç ‡¶∏‡¶Æ‡¶∏‡ßç‡¶Ø‡¶æ ‡¶∏‡¶Æ‡¶æ‡¶ß‡¶æ‡¶® ‡¶¶‡¶ï‡ßç‡¶∑‡¶§‡¶æ
‚Ä¢ ‡¶≠‡¶æ‡¶≤ ‡¶™‡ßç‡¶∞‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø‡¶ó‡¶§ ‡¶Ø‡ßã‡¶ó‡ßç‡¶Ø‡¶§‡¶æ
‚Ä¢ ‡¶∏‡ßÉ‡¶ú‡¶®‡¶∂‡ßÄ‡¶≤ ‡¶ö‡¶ø‡¶®‡ßç‡¶§‡¶æ‡¶≠‡¶æ‡¶¨‡¶®‡¶æ ‡¶ï‡ßç‡¶∑‡¶Æ‡¶§‡¶æ

üéØ  ‡¶∏‡ßÅ‡¶™‡¶æ‡¶∞‡¶ø‡¶∂‡¶ï‡ßÉ‡¶§ ‡¶ß‡¶æ‡¶∞‡¶æ: 
1.  ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶® (PCM)  - ‡¶á‡¶û‡ßç‡¶ú‡¶ø‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞‡¶ø‡¶Ç, ‡¶™‡ßç‡¶∞‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø, ‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶§‡ßç‡¶Ø
2.  ‡¶¨‡¶ø‡¶ú‡ßç‡¶û‡¶æ‡¶® (PCB)  - ‡¶ö‡¶ø‡¶ï‡¶ø‡ßé‡¶∏‡¶æ, ‡¶ú‡ßà‡¶¨‡¶™‡ßç‡¶∞‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§‡¶ø, ‡¶ó‡¶¨‡ßá‡¶∑‡¶£‡¶æ
3.  ‡¶¨‡¶æ‡¶£‡¶ø‡¶ú‡ßç‡¶Ø  - ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡¶æ, ‡¶Ö‡¶∞‡ßç‡¶•, ‡¶¨‡ßç‡¶Ø‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡¶™‡¶®‡¶æ

üí° ‡¶Ü‡¶™‡¶®‡¶ø ‡¶Ü‡¶∞‡¶ì ‡¶ï‡ßÄ ‡¶Ö‡¶®‡ßç‡¶¨‡ßá‡¶∑‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?`,
  gu: (name: string) => `‡™â‡™§‡´ç‡™§‡™Æ ‡™ï‡™æ‡™∞‡´ç‡™Ø, ${name}! üéâ

‡™§‡™Æ‡™æ‡™∞‡™æ ‡™∏‡™Ç‡™™‡´Ç‡™∞‡´ç‡™£ ‡™Æ‡´Ç‡™≤‡´ç‡™Ø‡™æ‡™Ç‡™ï‡™®‡™®‡™æ ‡™Ü‡™ß‡™æ‡™∞‡´á, ‡™Ö‡™π‡´Ä‡™Ç ‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™ï‡™æ‡™∞‡™ï‡™ø‡™∞‡´ç‡™¶‡´Ä‡™®‡´Ä ‡™≠‡™≤‡™æ‡™Æ‡™£‡´ã ‡™õ‡´á:

üìä  ‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™∂‡™ï‡´ç‡™§‡™ø‡™ì: 
‚Ä¢ ‡™Æ‡™ú‡™¨‡´Ç‡™§ ‡™µ‡™ø‡™∂‡´ç‡™≤‡´á‡™∑‡™£‡™æ‡™§‡´ç‡™Æ‡™ï ‡™Ö‡™®‡´á ‡™∏‡™Æ‡™∏‡´ç‡™Ø‡™æ ‡™®‡™ø‡™µ‡™æ‡™∞‡™£ ‡™ï‡´å‡™∂‡™≤‡´ç‡™Ø‡´ã
‚Ä¢ ‡™∏‡™æ‡™∞‡´Ä ‡™§‡™ï‡™®‡´Ä‡™ï‡´Ä ‡™Ø‡´ã‡™ó‡´ç‡™Ø‡™§‡™æ
‚Ä¢ ‡™∏‡™∞‡´ç‡™ú‡™®‡™æ‡™§‡´ç‡™Æ‡™ï ‡™µ‡™ø‡™ö‡™æ‡™∞‡™∏‡™∞‡™£‡´Ä ‡™ï‡´ç‡™∑‡™Æ‡™§‡™æ‡™ì

üéØ  ‡™≠‡™≤‡™æ‡™Æ‡™£ ‡™ï‡™∞‡´á‡™≤ ‡™™‡´ç‡™∞‡™µ‡™æ‡™π‡´ã: 
1.  ‡™µ‡™ø‡™ú‡´ç‡™û‡™æ‡™® (PCM)  - ‡™è‡™®‡´ç‡™ú‡™ø‡™®‡™ø‡™Ø‡™∞‡™ø‡™Ç‡™ó, ‡™ü‡´á‡™ï‡´ç‡™®‡´ã‡™≤‡´ã‡™ú‡´Ä, ‡™Ü‡™∞‡´ç‡™ï‡™ø‡™ü‡´á‡™ï‡´ç‡™ö‡™∞
2.  ‡™µ‡™ø‡™ú‡´ç‡™û‡™æ‡™® (PCB)  - ‡™Æ‡´á‡™°‡™ø‡™ï‡™≤, ‡™¨‡™æ‡™Ø‡´ã‡™ü‡´á‡™ï‡™®‡´ã‡™≤‡´ã‡™ú‡´Ä, ‡™∏‡™Ç‡™∂‡´ã‡™ß‡™®
3.  ‡™ï‡´ã‡™Æ‡™∞‡´ç‡™∏  - ‡™¨‡™ø‡™ù‡™®‡´á‡™∏, ‡™´‡™æ‡™á‡™®‡™æ‡™®‡´ç‡™∏, ‡™Æ‡´á‡™®‡´á‡™ú‡™Æ‡´á‡™®‡´ç‡™ü

üí° ‡™§‡™Æ‡´á ‡™µ‡™ß‡´Å ‡™∂‡´Å‡™Ç ‡™Ö‡™®‡´ç‡™µ‡´á‡™∑‡™£ ‡™ï‡™∞‡™µ‡™æ ‡™Æ‡™æ‡™Ç‡™ó‡´ã ‡™õ‡´ã?`
};

const initialMessages = {
  en: (name: string) => `Hello ${name}! I'm your career guidance assistant. I'm here to help you explore different career paths and streams. What would you like to know about?`,
  hi: (name: string) => `‡§®‡§Æ‡§∏‡•ç‡§§‡•á ${name}! ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡§æ ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§Æ‡§æ‡§∞‡•ç‡§ó‡§¶‡§∞‡•ç‡§∂‡§® ‡§∏‡§π‡§æ‡§Ø‡§ï ‡§π‡•Ç‡§Ç‡•§ ‡§Æ‡•à‡§Ç ‡§Ø‡§π‡§æ‡§Ç ‡§µ‡§ø‡§≠‡§ø‡§®‡•ç‡§® ‡§ï‡§∞‡§ø‡§Ø‡§∞ ‡§™‡§•‡•ã‡§Ç ‡§î‡§∞ ‡§∏‡•ç‡§ü‡•ç‡§∞‡•Ä‡§Æ ‡§ï‡§æ ‡§™‡§§‡§æ ‡§≤‡§ó‡§æ‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§π‡•Ç‡§Ç‡•§`,
  te: (name: string) => `‡∞π‡∞≤‡±ã ${name}! ‡∞®‡±á‡∞®‡±Å ‡∞Æ‡±Ä ‡∞ï‡±Ü‡∞∞‡±Ä‡∞∞‡±ç ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ó‡∞¶‡∞∞‡±ç‡∞∂‡∞ï ‡∞∏‡∞π‡∞æ‡∞Ø‡∞ï‡±Å‡∞°‡∞ø‡∞®‡∞ø‡•§ ‡∞µ‡∞ø‡∞µ‡∞ø‡∞ß ‡∞ï‡±Ü‡∞∞‡±Ä‡∞∞‡±ç ‡∞Æ‡∞æ‡∞∞‡±ç‡∞ó‡∞æ‡∞≤‡±Å ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞∏‡±ç‡∞ü‡±ç‡∞∞‡±Ä‡∞Æ‡±ç‚Äå‡∞≤‡∞®‡±Å ‡∞Ö‡∞®‡±ç‡∞µ‡±á‡∞∑‡∞ø‡∞Ç‡∞ö‡∞°‡∞Ç‡∞≤‡±ã ‡∞Æ‡±Ä‡∞ï‡±Å ‡∞∏‡∞π‡∞æ‡∞Ø‡∞Ç ‡∞ö‡±á‡∞Ø‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞®‡±á‡∞®‡±Å ‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞â‡∞®‡±ç‡∞®‡∞æ‡∞®‡±Å‡•§`,
  ta: (name: string) => `‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç ${name}! ‡Æ®‡Ææ‡Æ©‡Øç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç ‡Æµ‡Æ¥‡Æø‡Æï‡Ææ‡Æü‡Øç‡Æü‡Æø ‡Æâ‡Æ§‡Æµ‡Æø‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç. ‡Æ™‡Æ≤‡Øç‡Æµ‡Øá‡Æ±‡ØÅ ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç ‡Æ™‡Ææ‡Æ§‡Øà‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Æø‡Æ∞‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øà ‡ÆÜ‡Æ∞‡Ææ‡ÆØ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æâ‡Æ§‡Æµ ‡Æ®‡Ææ‡Æ©‡Øç ‡Æá‡Æô‡Øç‡Æï‡Øá ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡Æø‡Æ±‡Øá‡Æ©‡Øç.`,
  bn: (name: string) => `‡¶π‡ßç‡¶Ø‡¶æ‡¶≤‡ßã ${name}! ‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡ßá‡¶∂‡¶ø‡¶ï‡¶æ ‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡ßÄ‡•§ ‡¶Ü‡¶Æ‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶ï‡ßç‡¶Ø‡¶æ‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶• ‡¶è‡¶¨‡¶Ç ‡¶ß‡¶æ‡¶∞‡¶æ ‡¶Ö‡¶®‡ßç‡¶¨‡ßá‡¶∑‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶è‡¶∏‡ßá‡¶õ‡¶ø‡•§`,
  gu: (name: string) => `‡™®‡™Æ‡™∏‡´ç‡™§‡´á ${name}! ‡™π‡´Å‡™Ç ‡™§‡™Æ‡™æ‡™∞‡´ã ‡™ï‡™æ‡™∞‡™ï‡™ø‡™∞‡´ç‡™¶‡´Ä ‡™Æ‡™æ‡™∞‡´ç‡™ó‡™¶‡™∞‡´ç‡™∂‡™ï ‡™∏‡™π‡™æ‡™Ø‡™ï ‡™õ‡´Å‡™Ç. ‡™π‡´Å‡™Ç ‡™Ö‡™π‡´Ä‡™Ç ‡™§‡™Æ‡™®‡´á ‡™µ‡™ø‡™µ‡™ø‡™ß ‡™ï‡™æ‡™∞‡™ï‡™ø‡™∞‡´ç‡™¶‡´Ä ‡™Æ‡™æ‡™∞‡´ç‡™ó‡´ã ‡™Ö‡™®‡´á ‡™™‡´ç‡™∞‡™µ‡™æ‡™π‡´ã‡™®‡´Å‡™Ç ‡™Ö‡™®‡´ç‡™µ‡´á‡™∑‡™£ ‡™ï‡™∞‡™µ‡™æ‡™Æ‡™æ‡™Ç ‡™Æ‡™¶‡™¶ ‡™ï‡™∞‡™µ‡™æ ‡™Æ‡™æ‡™ü‡´á ‡™õ‡´Å‡™Ç.`
};

const connectionErrorMessages = {
  en: "Connection failed. Unable to process more queries at this time. Please try again in some time.",
  hi: "‡§ï‡§®‡•á‡§ï‡•ç‡§∂‡§® ‡§µ‡§ø‡§´‡§≤‡•§ ‡§á‡§∏ ‡§∏‡§Æ‡§Ø ‡§Ö‡§ß‡§ø‡§ï ‡§™‡•ç‡§∞‡§∂‡•ç‡§®‡•ã‡§Ç ‡§ï‡•ã ‡§∏‡§Ç‡§∏‡§æ‡§ß‡§ø‡§§ ‡§ï‡§∞‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ö‡§∏‡§Æ‡§∞‡•ç‡§•‡•§ ‡§ï‡•É‡§™‡§Ø‡§æ ‡§ï‡•Å‡§õ ‡§∏‡§Æ‡§Ø ‡§¨‡§æ‡§¶ ‡§™‡•Å‡§®‡§É ‡§™‡•ç‡§∞‡§Ø‡§æ‡§∏ ‡§ï‡§∞‡•á‡§Ç‡•§",
  te: "‡∞ï‡∞®‡±Ü‡∞ï‡±ç‡∞∑‡∞®‡±ç ‡∞µ‡∞ø‡∞´‡∞≤‡∞Æ‡±à‡∞Ç‡∞¶‡∞ø. ‡∞™‡±ç‡∞∞‡∞∏‡±ç‡∞§‡±Å‡∞§‡∞Ç ‡∞Æ‡∞∞‡∞ø‡∞®‡±ç‡∞®‡∞ø ‡∞™‡±ç‡∞∞‡∞∂‡±ç‡∞®‡∞≤‡∞®‡±Å ‡∞™‡±ç‡∞∞‡∞æ‡∞∏‡±Ü‡∞∏‡±ç ‡∞ö‡±á‡∞Ø‡∞°‡∞Ç ‡∞∏‡∞æ‡∞ß‡±ç‡∞Ø‡∞Ç‡∞≤‡±á‡∞¶‡±Å. ‡∞¶‡∞Ø‡∞ö‡±á‡∞∏‡∞ø ‡∞ï‡±ä‡∞Ç‡∞§‡∞∏‡∞Æ‡∞Ø‡∞Ç ‡∞§‡∞∞‡±ç‡∞µ‡∞æ‡∞§ ‡∞Æ‡∞≥‡±ç‡∞≤‡±Ä ‡∞™‡±ç‡∞∞‡∞Ø‡∞§‡±ç‡∞®‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø.",
  ta: "‡Æá‡Æ£‡Øà‡Æ™‡Øç‡Æ™‡ØÅ ‡Æ§‡Øã‡Æ≤‡Øç‡Æµ‡Æø‡ÆØ‡Æü‡Øà‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ. ‡Æ§‡Æ±‡Øç‡Æ™‡Øã‡Æ§‡ØÅ ‡ÆÆ‡Øá‡Æ≤‡ØÅ‡ÆÆ‡Øç ‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø‡Æï‡Æ≥‡Øà ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Ææ‡Æï‡Øç‡Æï ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà. ‡Æ§‡ÆØ‡Æµ‡ØÅ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡ØÅ ‡Æö‡Æø‡Æ±‡Æø‡Æ§‡ØÅ ‡Æ®‡Øá‡Æ∞‡ÆÆ‡Øç ‡Æï‡Æ¥‡Æø‡Æ§‡Øç‡Æ§‡ØÅ ‡ÆÆ‡ØÄ‡Æ£‡Øç‡Æü‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡ØÅ‡ÆØ‡Æ±‡Øç‡Æö‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç.",
  bn: "‡¶∏‡¶Ç‡¶Ø‡ßã‡¶ó ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶• ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá‡•§ ‡¶è‡¶á ‡¶Æ‡ßÅ‡¶π‡ßÇ‡¶∞‡ßç‡¶§‡ßá ‡¶Ü‡¶∞‡¶ì ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶∏‡¶Æ‡ßç‡¶≠‡¶¨ ‡¶®‡¶Ø‡¶º‡•§ ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶ï‡¶ø‡¶õ‡ßÅ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶™‡¶∞‡ßá ‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§",
  gu: "‡™ï‡™®‡´á‡™ï‡´ç‡™∂‡™® ‡™®‡™ø‡™∑‡´ç‡™´‡™≥ ‡™•‡™Ø‡´Å‡™Ç. ‡™Ü ‡™∏‡™Æ‡™Ø‡´á ‡™µ‡™ß‡´Å ‡™™‡´ç‡™∞‡™∂‡´ç‡™®‡´ã‡™®‡´Ä ‡™™‡´ç‡™∞‡™ï‡´ç‡™∞‡™ø‡™Ø‡™æ ‡™∂‡™ï‡´ç‡™Ø ‡™®‡™•‡´Ä. ‡™ï‡´É‡™™‡™æ ‡™ï‡™∞‡´Ä‡™®‡´á ‡™•‡´ã‡™°‡™æ ‡™∏‡™Æ‡™Ø ‡™™‡™õ‡´Ä ‡™´‡™∞‡´Ä ‡™™‡´ç‡™∞‡™Ø‡™æ‡™∏ ‡™ï‡™∞‡´ã."
};

const MAX_USER_MESSAGES = 5;

export function ChatbotPage({ userProfile, setUserProfile, navigateTo, showResults = false }: ChatbotPageProps) {
  const getInitialMessage = (): Message => {
    if (showResults) {
      return {
        id: 1,
        text: resultsMessages[userProfile.language](userProfile.name),
        sender: 'bot',
        timestamp: new Date()
      };
    }
    return {
      id: 1,
      text: initialMessages[userProfile.language](userProfile.name),
      sender: 'bot',
      timestamp: new Date()
    };
  };

  const [messages, setMessages] = useState<Message[]>([getInitialMessage()]);
  const [inputValue, setInputValue] = useState('');
  const [userMessageCount, setUserMessageCount] = useState(0);
  const [isLimitReached, setIsLimitReached] = useState(false);
  const [isTyping, setIsTyping] = useState(false);
  const messagesEndRef = useRef<HTMLDivElement>(null);

  const handleLanguageChange = (lang: Language) => {
    setUserProfile({ ...userProfile, language: lang });
  };

  const scrollToBottom = () => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  const handleSendMessage = () => {
    if (!inputValue.trim() || isLimitReached) return;

    const newUserMessageCount = userMessageCount + 1;
    
    const userMessage: Message = {
      id: messages.length + 1,
      text: inputValue,
      sender: 'user',
      timestamp: new Date()
    };

    setMessages([...messages, userMessage]);
    setInputValue('');
    setUserMessageCount(newUserMessageCount);

    // Check if limit reached
    if (newUserMessageCount >= MAX_USER_MESSAGES) {
      setIsLimitReached(true);
      return;
    }

    // Simulate bot response with typing indicator
    setIsTyping(true);
    setTimeout(() => {
      const lowerInput = inputValue.toLowerCase();
      let responseText = botResponses.default[userProfile.language];

      for (const [key, response] of Object.entries(botResponses)) {
        if (key !== 'default' && lowerInput.includes(key)) {
          responseText = response[userProfile.language];
          break;
        }
      }

      const botMessage: Message = {
        id: messages.length + 2,
        text: responseText,
        sender: 'bot',
        timestamp: new Date()
      };

      setMessages(prev => [...prev, botMessage]);
      setIsTyping(false);
    }, 1000);
  };

  const handleKeyPress = (e: React.KeyboardEvent) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleSendMessage();
    }
  };

  return (
    <div className="min-h-screen flex flex-col">
      {/* Header */}
      <header className="bg-white shadow-sm border-b sticky top-0 z-10">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          <div className="flex items-center gap-4">
            <Button 
              variant="ghost" 
              size="icon"
              onClick={() => navigateTo('home')}
            >
              <ArrowLeft className="h-5 w-5" />
            </Button>
            <div className="flex items-center gap-3 flex-1">
              <div className="bg-gradient-to-br from-blue-500 to-purple-500 p-2 rounded-xl">
                <Bot className="h-6 w-6 text-white" />
              </div>
              <div>
                <h2 className="text-gray-900">Career Guide</h2>
                <p className="text-green-600 text-sm">‚óè Online</p>
              </div>
            </div>
            <LanguageSelector 
              language={userProfile.language}
              onLanguageChange={handleLanguageChange}
            />
          </div>
        </div>
      </header>

      {/* Chat Messages */}
      <main className="flex-1 overflow-y-auto bg-gradient-to-br from-blue-50 via-white to-purple-50">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-4">
          {messages.map((message) => (
            <div
              key={message.id}
              className={`flex gap-3 ${message.sender === 'user' ? 'flex-row-reverse' : 'flex-row'}`}
            >
              <Avatar className="h-8 w-8 shrink-0">
                <AvatarFallback className={message.sender === 'bot' ? 'bg-gradient-to-br from-blue-500 to-purple-500 text-white' : 'bg-gray-300'}>
                  {message.sender === 'bot' ? <Bot className="h-4 w-4" /> : <User className="h-4 w-4" />}
                </AvatarFallback>
              </Avatar>
              <div className={`flex flex-col max-w-[70%] ${message.sender === 'user' ? 'items-end' : 'items-start'}`}>
                <Card className={`p-3 ${message.sender === 'user' ? 'bg-blue-600 text-white border-blue-600' : 'bg-white'}`}>
                  <p className="text-sm whitespace-pre-wrap">{message.text}</p>
                </Card>
                <span className="text-xs text-gray-500 mt-1">
                  {message.timestamp.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' })}
                </span>
              </div>
            </div>
          ))}
          
          {/* Typing Indicator */}
          {isTyping && (
            <div className="flex gap-3 flex-row">
              <Avatar className="h-8 w-8 shrink-0">
                <AvatarFallback className="bg-gradient-to-br from-blue-500 to-purple-500 text-white">
                  <Bot className="h-4 w-4" />
                </AvatarFallback>
              </Avatar>
              <div className="flex flex-col max-w-[70%] items-start">
                <Card className="p-3 bg-white">
                  <div className="flex gap-1 items-center">
                    <span className="text-sm text-gray-600">typing</span>
                    <div className="flex gap-1">
                      <span className="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '0ms' }}></span>
                      <span className="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '150ms' }}></span>
                      <span className="w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce" style={{ animationDelay: '300ms' }}></span>
                    </div>
                  </div>
                </Card>
              </div>
            </div>
          )}
          
          <div ref={messagesEndRef} />
        </div>
      </main>

      {/* Input Area */}
      <div className="bg-white border-t sticky bottom-0">
        <div className="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
          {isLimitReached && (
            <Alert className="mb-4 border-red-200 bg-red-50">
              <AlertCircle className="h-4 w-4 text-red-600" />
              <AlertDescription className="text-red-800 text-sm">
                ‚ö†Ô∏è {connectionErrorMessages[userProfile.language]}
              </AlertDescription>
            </Alert>
          )}
          <div className="flex gap-3">
            <Textarea
              value={inputValue}
              onChange={(e) => setInputValue(e.target.value)}
              onKeyPress={handleKeyPress}
              placeholder={isLimitReached ? "Connection failed..." : "Type your question here..."}
              className="resize-none min-h-[60px]"
              rows={2}
              disabled={isLimitReached}
            />
            <Button 
              onClick={handleSendMessage}
              className="bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 shrink-0"
              size="icon"
              disabled={isLimitReached}
            >
              <Send className="h-5 w-5" />
            </Button>
          </div>
          {!isLimitReached && (
            <p className="text-xs text-gray-500 mt-2 text-center">
              Press Enter to send, Shift+Enter for new line
            </p>
          )}
        </div>
      </div>
    </div>
  );
}
